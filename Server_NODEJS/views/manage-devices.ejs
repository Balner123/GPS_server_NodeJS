<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('partials/_head.ejs', {title: 'Device Details'}) %>
</head>
<body>
    <%- include('partials/_navbar.ejs') %>

    <div class="container mt-4">
        <div class="row">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="card-title mb-0">Device List</h5>
                    </div>
                    <div class="card-body">
                        <div id="devices-list"></div>
                    </div>
                </div>
                <div class="card mt-4" id="device-settings-card" style="display: none;">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Device Settings</h5>
                    </div>
                    <div class="card-body">
                        <form id="device-settings-form">
                            <div class="mb-3">
                                <label for="mode-select" class="form-label">Mode:</label>
                                <select class="form-select" id="mode-select">
                                    <option value="simple">Simple</option>
                                    <option value="batch">Batch</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">GPS Fix Interval (DD:HH:MM:SS):</label>
                                <div class="input-group">
                                    <input type="number" class="form-control text-center" id="interval-gps-days" placeholder="DD" min="0" value="00">
                                    <span class="input-group-text">:</span>
                                    <input type="number" class="form-control text-center" id="interval-gps-hours" placeholder="HH" min="0" max="23" value="00">
                                    <span class="input-group-text">:</span>
                                    <input type="number" class="form-control text-center" id="interval-gps-minutes" placeholder="MM" min="0" max="59" value="00">
                                    <span class="input-group-text">:</span>
                                    <input type="number" class="form-control text-center" id="interval-gps-seconds" placeholder="SS" min="0" max="59" value="00">
                                </div>
                                <div class="form-text">The time interval between each GPS fix attempt.</div>
                            </div>
                            <div class="mb-3" id="batch-settings" style="display: none;">
                                <label for="interval-send" class="form-label">Send Data Interval:</label>
                                <input type="number" class="form-control" id="interval-send" placeholder="Number of cycles" min="1" value="1">
                                <div class="form-text">Send data to server after this many GPS fixes.</div>
                            </div>
                            <button type="submit" class="btn btn-primary">Save Settings</button>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Live Map</h5>
                    </div>
                    <div class="card-body">
                        <div id="history-map" style="height: 400px;"></div>
                    </div>
                </div>
                <div class="card mt-4">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Location History</h5>
                        <button id="toggle-history-btn" class="btn btn-sm btn-outline-primary" style="display: none;">Zobrazit v≈°e</button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Latitude</th>
                                        <th>Longitude</th>
                                        <th>Speed</th>
                                        <th>Altitude</th>
                                        <th>Accuracy</th>
                                        <th>Satellites</th>
                                    </tr>
                                </thead>
                                <tbody id="positions-table"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <%- include('partials/_footer.ejs') %>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="/js/common.js"></script>
    <script src="/js/device.js"></script>
</body>
</html>